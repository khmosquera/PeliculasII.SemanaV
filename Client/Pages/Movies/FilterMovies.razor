@page "/movie/filter"
@using PeliculaIISemanaIV.Client.Pages.Components
@inject IServiceMovieII movie
<div class="container">
    <div class="jumbotron">
    <div class="form-group mb-3">
        <input type="text" @bind-Value="movie_name" @bind-Value:event="oninput" @onkeypress="@((KeyboardEventArgs e)=>MovieSearch(e))"
        class="form-control" id="movie_name" placeholder="Buscar pelicula" />
    </div>
    @*Lista Desplegables*@
    <div class="form-group mx-sm-3 mb-3">
        <select class="form-control" @bind="CategorySelected">
        <option value="0">Seleccion una Categoria </option>
        @foreach (var item in categories)
        {
          <option value="@item.Id">@item.Name</option>
        }
        </select>
    </div>
    <div class="form-inline">
        <div class="form-group mx-sm-3 mb-3">
                <input type="checkbox" class="form-check-input" id="estrenos" @bind="futurosestrenos">
                <label class="form-check-label" for="estrenos">Proximos Estrenos</label>
        </div>

        <div class="form-group mx-sm-3 mb-3">
                <input type="checkbox" class="form-check-input" id="cartelera" @bind="enCartelera">
                <label class="form-check-label" for="cartelera">En Cartelera</label>
        </div>

        <div class="form-group mx-sm-3 mb-3">
                <input type="checkbox" class="form-check-input" id="mejor_calificada" @bind="mejorCalificada">
                <label class="form-check-label" for="mejor_calificada">Mejor Calificadas</label>
        </div>
    </div>
    <div>
        <button type="button" class="btn btn-primary mb-2 mx-sm-3" @onclick="ShowMovies"> Buscar</button>
        <button type="button" class="btn btn-danger mb-2 mx-sm-3" @onclick="ClearInputs"> Limpiar Campos</button>
    </div>
</div>
<ServiceComponent Movies= "Movies"></ServiceComponent>
</div>


@code{
        private List<Movie> Movies;
        private List<Category> categories = new List<Category>(); 
        string movie_name = "";
        string CategorySelected ="";
        private bool futurosestrenos = false;
        private bool enCartelera = false;
        private bool mejorCalificada = false;

        protected override void OnInitialized(){
            Movies=movie.GetMovies();            
        }

        private void ShowMovies(){
            Movies = movie.GetMovies().Where(x=>x.Name.ToLower().Contains(movie_name.ToLower())).ToList();
            Console.WriteLine($"Pelicula : {movie_name}, categoria seleccionada {CategorySelected}");
            Console.WriteLine($"Proximos Estrenos : {futurosestrenos}, en cartelera {enCartelera} mejor calificada {mejorCalificada}");
        }
        
        private void ClearInputs(){
            Movies = movie.GetMovies();
            movie_name = "";
            CategorySelected = "0";
            futurosestrenos = false;
            enCartelera = false;
            mejorCalificada = false;
        }
        private void MovieSearch(KeyboardEventArgs e){
            if (e.Key == "Enter")
            {
                ShowMovies();
            }
        }
        
}



